# Exploratory analysis of text data

##Necessary libraries
```{r}
suppressWarnings(suppressPackageStartupMessages(library(data.table)))
suppressWarnings(suppressPackageStartupMessages(library(dplyr)))
suppressWarnings(suppressPackageStartupMessages(library(tokenizers)))
```

##Read in the data
```{r}
suppressWarnings(
blogs <- readLines("Data/en_US/en_US.blogs.txt"))
suppressWarnings(
tweets <- readLines("Data/en_US/en_US.twitter.txt"))
suppressWarnings(
news <- readLines("Data/en_US/en_US.news.txt"))
```

```{r}
# Number of lines
# Blogs
b_count <- length(blogs)
# Tweets
t_count <- length(tweets)
# News
n_count <- length(news)
```

```{r}
# To words
dt_blogs <- dt_characterVectorToTable(blogs)
dt_tweets <- dt_characterVectorToTable(tweets)
dt_news <- dt_characterVectorToTable(news)
dt_all <- rbind(dt_blogs, dt_news, dt_tweets)

# Freqiencies 
dt_blogs_freq <- dt_calculateWordFrequencies(dt_blogs, "words")
dt_tweets_freq <- dt_calculateWordFrequencies(dt_tweets, "words")
dt_news_freq <- dt_calculateWordFrequencies(dt_news, "words")
dt_all_freq <- dt_calculateWordFrequencies(dt_all, "words")

```

The plots below show two looks at the word distributions in the text.
```{r}
par(mfrow = c(1,2))
hist(dt_all_freq$Frequency, breaks = 100000, xlim = c(0.00005,0.0000000001), ylim = c(0,10000), 
     main = "Most words have very low frequency")
hist(dt_all_freq$Frequency, breaks = 10000, xlim = c(0.00005,0.000001), ylim = c(0,1000), 
     main = "A small percentage of the words have very high frequencies")
```

There is nothing like a little text analysis to make you realize the importance of connecting words. The top 10 words, of which 8 are connectors and 2 are pronouns, describe ~20% of the text.  
```{r}
#plot the frequency for the top ten words 
plot(as.factor(head(dt_all_freq$dt, 10)), head(dt_all_freq$Frequency,10), type = "l", 
     main = "The most frequent words in the three texts and their frequencies")
```

Further exploration shows that the top `r nrow(dt_all_freq) - nrow(dt_all_freq[PercentageTextDescribed >= 0.9,])` words can be used to describe 90% of the text. With  `r nrow(dt_all_freq) - nrow(dt_all_freq[PercentageTextDescribed >= 0.95,])` words we can descibe 95% of the texts.

